# 一、多表查询概念
多表查询：指从多张表中查询数据，查询结果为笛卡尔积。在多表查询时，需要消除无效的笛卡尔积。
笛卡尔积：笛卡尔乘积是指在数学中，两个集合（A集合 和 B集合）的所有组合情况。

```sql
-- 单表查询
select * form emp;		-- 30 条数据员工
select * form dept; 		-- 5 条数据部门数据

-- 多表查询结果为 笛卡尔积
select * from emp, dept; 	-- 30 x 5 = 150 条数据

-- ⚠️ 多表查询，通过 where 条件消除笛卡尔积，过滤出有效数据
select * from emp, dept where emp.dept_id = dept.id;
```


# 二、多表查询的分类

## 1、连接查询

### 1.1、内连接 --- 取多表的交集
即查询 A、B 交集部分数据，语法如下：
```sql
-- 1、隐式内连接（常用）
select 字段列表 from 表1, 表2 where 连接条件...;
	
-- 2、显式内连接
select 字段列表 from 表1 [inner] join 表2 on 连接条件... [where 其它查询条件...];
```
	
> 注意：
> 显式内连接查询，消除笛卡尔积的连接条件放在 on 后面，其它查询条件放在 where 后面；

### 1.2、外连接：	--- 取某一个全集
左外连接：查询左表所有数据（且包括两张表交集部分数据）；
右外连接：查询右表所有数据（包括两张表交集部分数据）;

语法如下：
```sql
-- 1、左外连接（常用），即以 表1 为需要全部展示的数据；
select 字段列表 from 表1 left [outer] join 表2 on 连接条件 ...;

-- 2、右外连接，即以 表2 为需要全部展示的数据；
select 字段列表 from 表1 right [outer] join 表2 on 连接条件 ...;
```

> ⚠️ 注意：
> 对于外连接，常用的是左外连接，因为右外连接的SQL也可以改造成为左外连接(两张表调换个顺序)。
> 当查询需求里出现 “所有” 时，则需要使用 外连接。



## 2、子查询
SQL 语句中嵌套 `select` 语句，称为嵌套查询，又称子查询。
如下，(select column1 from t2 ...) 子查询语句 ：
```sql 
select * from t1 where column1 = (select column1 from t2 ...);
```

> 子查询 外部的语句 可以是 `insert / update / delete / select` 的任何一个，最常见的是 select。

* 子查询分类：
1. 标量子查询：子查询的返回结果为单个值；
2. 列子查询：子查询的返回结果为一列，可以有多行；
3. 行子查询：子查询的返回结果为一行，可以有多列；
4. 表子查询：子查询返回的结果为多行多列（相当于一个临时表）；

> 子查询的要点是，先对需求做拆分，明确具体的步骤，然后再逐步编写 SQL 语句。
