# 一、异步消息的可靠性问题
前面学习了 RabbitMQ 异步消息的收发，已经能满足大多数业务场景需求。而在一些特殊业务中，不仅要做消息的收发，还需保证消息收发的高可靠性。
要满足 RabbitMQ 收发消息的高可靠性就要使用其高级功能。

影响消息高可靠性的原因有哪些？

## 1、问题分析
如下用户通过余额支付的流程：
```
【支付服务】 ---OpenFeign 远程调用--> 【用户服务】 --扣减余额--> 【DB】
        
        ---> 【支付服务】本地更新支付状态【DB】
        
        ---发送消息通知
            --> 【RabbitMQ 消息代理】 --转发--> 【交易服务】 --更新订单---> 【DB】
```
存在如下消息丢失的问题时，会造成 [交易服务] 中订单状态更新失败的问题：
1. 【支付服务】发送消息到 【RabbitMQ 消息代理】时出现网络故障；--- 发送者丢失
2. 【RabbitMQ 消息代理】转发消息时，RabbitMQ 服务挂掉了；--- MQ丢失
3. 【交易服务】接收消息时服务挂掉了；--- 消费者丢失

## 2、解决消息可靠性的方面
* 发送者 可靠性 -- 确保消息能发送到MQ
* MQ的可靠性
* 消费者的可靠性
* 延迟消息（可靠性兜底方案）
