# 一、复合查询
复合查询大致可以分为两类：

- 第一类：基于逻辑运算组合叶子查询，实现组合条件，例如
    - `bool`
- 第二类：基于某种算法修改查询时的文档 `相关性算分`，从而改变文档排名。例如：
    - `function_score`
    - `dis_max`

## 1、复合查询 - bool 查询
`bool` 查询，即布尔查询。就是利用逻辑运算来组合一个或多个查询子句的组合。`bool` 查询支持的逻辑运算有：
- `must`：必须匹配每个子查询，类似 `与`。；
- `should`：选择性匹配子查询，类似 `或`；
- `must_not`：必须不匹配，不参与算分，类似 `非`；
- `filter`：必须匹配，不参与算分。与 must 类似，常用于过滤筛选搜索；

> 出于性能考虑，用户输入的搜索关键字都应参与算分，应使用 must、should；与搜索关键字无关的查询尽量采用 must_not 或 filter 逻辑运算，避免参与相关性算分。

```shell
# 案例 - 搜索"智能手机"，但品牌必须是华为，价格必须是900~1599
GET /items/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "name": "智能手机"
          }
        }
      ],
      "filter": [
        {
          "term": {
            "brand.keyword": "华为"
          }
        },
        {
          "range": {
            "price": {
              "gte": 90000,
              "lte": 159900
            }
          }
        }
      ]
    }
  }
}
```